{% extends 'base.html.twig' %}

{% block title %}Profil utilisateur{% endblock %}

{% block body %}
<div class="max-w-2xl mx-auto mt-8">
    <h2 class="text-2xl  text-center font-bold mb-4">News du moment</h2>
    <div class="space-y-4" x-data>
        <div class="flex items-around md:grid-cols-3 gap-6">
            <!-- Staff News Column -->
            <div class="bg-GREEN p-4 rounded-lg">
                <h3 class="text-xl font-bold text-white mb-4 text-center">Communications Staff</h3>
                {% for news in news_staff %}
                    <div
                        x-data="{ show: false, open: false }"
                        x-init="setTimeout(() => show = true, {{ loop.index0 * 200 }})"
                        x-show="show"
                        x-transition:enter="transition-transform transition-opacity duration-1000"
                        x-transition:enter-start="opacity-0 scale-90"
                        x-transition:enter-end="opacity-100 scale-100"
                        class="bg-white text-gray-800 shadow-lg rounded-lg p-4 mb-4"
                        style="display: none;"
                    >
                        <div class="flex flex-col gap-1 mb-2">
                            <span class="font-bold text-lg">
                                {{ news.titre ? news.titre : 'Sans titre' }}
                            </span>
                            <span class="text-xs bg-red-500 text-white px-2 py-1 rounded w-fit">
                                {{ news.Emetteur ? news.Emetteur.username ~ ': ' ~ news.Emetteur.getBestRole() : 'Anonyme' }}
                            </span>
                            <span class="text-sm text-gray-500">
                                {{ news.dateCreation ? news.dateCreation|date('d/m/Y H:i') : '' }}
                            </span>
                        </div>
                        <button command="show-modal" commandfor="dialog-staff-{{ loop.index0 }}" class="rounded-md bg-VIOLET px-2.5 py-1.5 text-sm font-semibold text-white inset-ring inset-ring-white/5">Lire</button>
                        
                        <el-dialog>
                            <dialog id="dialog-staff-{{ loop.index0 }}" aria-labelledby="dialog-title-staff-{{ loop.index0 }}" class="fixed inset-0 size-auto max-h-none max-w-none overflow-y-auto bg-transparent backdrop:bg-transparent">
                                <el-dialog-backdrop class="fixed inset-0 bg-gray-900/50 transition-opacity data-closed:opacity-0 data-enter:duration-300 data-enter:ease-out data-leave:duration-200 data-leave:ease-in"></el-dialog-backdrop>
                                <div tabindex="0" class="flex min-h-full items-end justify-center p-4 text-center focus:outline-none sm:items-center sm:p-0">
                                    <el-dialog-panel class="relative transform overflow-hidden rounded-lg bg-gray-800 text-left shadow-xl outline -outline-offset-1 outline-white/10 transition-all data-closed:translate-y-4 data-closed:opacity-0 data-enter:duration-300 data-enter:ease-out data-leave:duration-200 data-leave:ease-in sm:my-8 sm:w-full sm:max-w-lg data-closed:sm:translate-y-0 data-closed:sm:scale-95">
                                        <div class="bg-gray-800 px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
                                            <div class="sm:flex sm:items-start">
                                                <div class="mx-auto flex size-12 shrink-0 items-center justify-center rounded-full bg-red-500/10 sm:mx-0 sm:size-10 overflow-hidden">
                                                    <img src="{{ asset('build/images/news_logos/staffSAO.jpg') }}" alt="Staff" class="w-full h-full object-cover">
                                                </div>
                                                <div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left">
                                                    <p class="text-WHITE">Communication Staff</p>
                                                    <h3 id="dialog-title-staff-{{ loop.index0 }}" class="text-base font-semibold text-white">{{ news.titre }}</h3>
                                                    <div class="mt-2">
                                                        <p class="text-sm text-gray-400">{{ news.content }}</p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="bg-gray-700/25 px-4 py-3 sm:flex sm:flex-row-reverse sm:px-6">
                                            <button type="button" command="close" commandfor="dialog-staff-{{ loop.index0 }}" class="mt-3 inline-flex w-full justify-center rounded-md bg-white/10 px-3 py-2 text-sm font-semibold text-white inset-ring inset-ring-white/5 hover:bg-white/20 sm:mt-0 sm:w-auto">Sortir</button>
                                        </div>
                                    </el-dialog-panel>
                                </div>
                            </dialog>
                        </el-dialog>
                    </div>
                {% else %}
                    <div class="text-white text-center py-4">Aucune communication staff.</div>
                {% endfor %}
            </div>

            <!-- Feature News Column -->
            <div class="bg-VIOLET p-4 rounded-lg">
                <h3 class="text-xl font-bold text-white mb-4 text-center">Nouvelles Fonctionnalités</h3>
                {% for news in news_feature %}
                    <div
                        x-data="{ show: false, open: false }"
                        x-init="setTimeout(() => show = true, {{ loop.index0 * 200 }})"
                        x-show="show"
                        x-transition:enter="transition-transform transition-opacity duration-1000"
                        x-transition:enter-start="opacity-0 scale-90"
                        x-transition:enter-end="opacity-100 scale-100"
                        class="bg-white text-gray-800 shadow-lg rounded-lg p-4 mb-4"
                        style="display: none;"
                    >
                        <div class="flex flex-col gap-1 mb-2">
                            <span class="font-bold text-lg">
                                {{ news.titre ? news.titre : 'Sans titre' }}
                            </span>
                            <span class="text-xs bg-blue-500 text-white px-2 py-1 rounded w-fit">
                                {{ news.Emetteur ? news.Emetteur.username ~ ': ' ~ news.Emetteur.getBestRole() : 'Anonyme' }}
                            </span>
                            <span class="text-sm text-gray-500">
                                {{ news.dateCreation ? news.dateCreation|date('d/m/Y H:i') : '' }}
                            </span>
                        </div>
                        <button command="show-modal" commandfor="dialog-feature-{{ loop.index0 }}" class="rounded-md bg-VIOLET px-2.5 py-1.5 text-sm font-semibold text-white inset-ring inset-ring-white/5">Lire</button>
                        
                        <el-dialog>
                            <dialog id="dialog-feature-{{ loop.index0 }}" aria-labelledby="dialog-title-feature-{{ loop.index0 }}" class="fixed inset-0 size-auto max-h-none max-w-none overflow-y-auto bg-transparent backdrop:bg-transparent">
                                <el-dialog-backdrop class="fixed inset-0 bg-gray-900/50 transition-opacity data-closed:opacity-0 data-enter:duration-300 data-enter:ease-out data-leave:duration-200 data-leave:ease-in"></el-dialog-backdrop>
                                <div tabindex="0" class="flex min-h-full items-end justify-center p-4 text-center focus:outline-none sm:items-center sm:p-0">
                                    <el-dialog-panel class="relative transform overflow-hidden rounded-lg bg-gray-800 text-left shadow-xl outline -outline-offset-1 outline-white/10 transition-all data-closed:translate-y-4 data-closed:opacity-0 data-enter:duration-300 data-enter:ease-out data-leave:duration-200 data-leave:ease-in sm:my-8 sm:w-full sm:max-w-lg data-closed:sm:translate-y-0 data-closed:sm:scale-95">
                                        <div class="bg-gray-800 px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
                                            <div class="sm:flex sm:items-start">
                                                <div class="mx-auto flex size-12 shrink-0 items-center justify-center rounded-full bg-blue-500/10 sm:mx-0 sm:size-10 overflow-hidden">
                                                    <img src="{{ asset('build/images/news_logos/feature.png') }}" alt="Feature" class="w-full h-full object-cover">
                                                </div>
                                                <div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left">
                                                    <p class="text-WHITE">Nouvelle Fonctionnalité</p>
                                                    <h3 id="dialog-title-feature-{{ loop.index0 }}" class="text-base font-semibold text-white">{{ news.titre }}</h3>
                                                    <div class="mt-2">
                                                        <p class="text-sm text-gray-400">{{ news.content }}</p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="bg-gray-700/25 px-4 py-3 sm:flex sm:flex-row-reverse sm:px-6">
                                            <button type="button" command="close" commandfor="dialog-feature-{{ loop.index0 }}" class="mt-3 inline-flex w-full justify-center rounded-md bg-white/10 px-3 py-2 text-sm font-semibold text-white inset-ring inset-ring-white/5 hover:bg-white/20 sm:mt-0 sm:w-auto">Sortir</button>
                                        </div>
                                    </el-dialog-panel>
                                </div>
                            </dialog>
                        </el-dialog>
                    </div>
                {% else %}
                    <div class="text-white text-center py-4">Aucune nouvelle fonctionnalité.</div>
                {% endfor %}
            </div>

            <!-- Maintenance News Column -->
            <div class="bg-GRAY p-4 rounded-lg">
                <h3 class="text-xl font-bold text-white mb-4 text-center">Notes de Maintenance</h3>
                {% for news in news_maintenance %}
                    <div
                        x-data="{ show: false, open: false }"
                        x-init="setTimeout(() => show = true, {{ loop.index0 * 200 }})"
                        x-show="show"
                        x-transition:enter="transition-transform transition-opacity duration-1000"
                        x-transition:enter-start="opacity-0 scale-90"
                        x-transition:enter-end="opacity-100 scale-100"
                        class="bg-white text-gray-800 shadow-lg rounded-lg p-4 mb-4"
                        style="display: none;"
                    >
                        <div class="flex flex-col gap-1 mb-2">
                            <span class="font-bold text-lg">
                                {{ news.titre ? news.titre : 'Sans titre' }}
                            </span>
                            <span class="text-xs bg-yellow-500 text-black px-2 py-1 rounded w-fit">
                                {{ news.Emetteur ? news.Emetteur.username ~ ': ' ~ news.Emetteur.getBestRole() : 'Anonyme' }}
                            </span>
                            <span class="text-sm text-gray-500">
                                {{ news.dateCreation ? news.dateCreation|date('d/m/Y H:i') : '' }}
                            </span>
                        </div>
                        <button command="show-modal" commandfor="dialog-maintenance-{{ loop.index0 }}" class="rounded-md bg-VIOLET px-2.5 py-1.5 text-sm font-semibold text-white inset-ring inset-ring-white/5">Lire</button>
                        
                        <el-dialog>
                            <dialog id="dialog-maintenance-{{ loop.index0 }}" aria-labelledby="dialog-title-maintenance-{{ loop.index0 }}" class="fixed inset-0 size-auto max-h-none max-w-none overflow-y-auto bg-transparent backdrop:bg-transparent">
                                <el-dialog-backdrop class="fixed inset-0 bg-gray-900/50 transition-opacity data-closed:opacity-0 data-enter:duration-300 data-enter:ease-out data-leave:duration-200 data-leave:ease-in"></el-dialog-backdrop>
                                <div tabindex="0" class="flex min-h-full items-end justify-center p-4 text-center focus:outline-none sm:items-center sm:p-0">
                                    <el-dialog-panel class="relative transform overflow-hidden rounded-lg bg-gray-800 text-left shadow-xl outline -outline-offset-1 outline-white/10 transition-all data-closed:translate-y-4 data-closed:opacity-0 data-enter:duration-300 data-enter:ease-out data-leave:duration-200 data-leave:ease-in sm:my-8 sm:w-full sm:max-w-lg data-closed:sm:translate-y-0 data-closed:sm:scale-95">
                                        <div class="bg-gray-800 px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
                                            <div class="sm:flex sm:items-start">
                                                <div class="mx-auto flex size-12 shrink-0 items-center justify-center rounded-full bg-yellow-500/10 sm:mx-0 sm:size-10 overflow-hidden">
                                                    <img src="{{ asset('build/images/news_logos/maintenance.jpg') }}" alt="Maintenance" class="w-full h-full object-cover">
                                                </div>
                                                <div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left">
                                                    <p class="text-WHITE">Note de maintenance</p>
                                                    <h3 id="dialog-title-maintenance-{{ loop.index0 }}" class="text-base font-semibold text-white">{{ news.titre }}</h3>
                                                    <div class="mt-2">
                                                        <p class="text-sm text-gray-400">{{ news.content }}</p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="bg-gray-700/25 px-4 py-3 sm:flex sm:flex-row-reverse sm:px-6">
                                            <button type="button" command="close" commandfor="dialog-maintenance-{{ loop.index0 }}" class="mt-3 inline-flex w-full justify-center rounded-md bg-white/10 px-3 py-2 text-sm font-semibold text-white inset-ring inset-ring-white/5 hover:bg-white/20 sm:mt-0 sm:w-auto">Sortir</button>
                                        </div>
                                    </el-dialog-panel>
                                </div>
                            </dialog>
                        </el-dialog>
                    </div>
                {% else %}
                    <div class="text-white text-center py-4">Aucune note de maintenance.</div>
                {% endfor %}
            </div>
        </div>
    </div>
    <!-- Alpine.js CDN for interactivity -->
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindplus/elements@1" type="module"></script>
</div>
{% endblock %}
